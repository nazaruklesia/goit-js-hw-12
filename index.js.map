{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n// import iziToast from \"izitoast\";\nexport { getPictures, addPages, resetPage };\n\nlet page = 1;\nconst perPage = 15;\n\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"47376974-17318822de3408abf70e5a971\";\n\n\nasync function getPictures(query) {\n    try {\n            const response = await axios(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                page,\n                per_page: perPage,\n            },\n        });\n        return response.data;  \n    } catch(error){\n        throw new Error('Failed to fetch pictures');\n     }\n   \n        \n    \n   \n}\n\n async function addPages() {\n    page += 1;\n}\n\n async function resetPage() {\n    page = 1;\n}\n","export function reflectionPictures(pictures) {\n  return pictures.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n    <a class=\"gallery-item\" href=\"${largeImageURL}\">\n      <div class=\"all-gallery\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\">\n        <div class=\"description\">\n          <p>Likes: <span>${likes}</span></p>\n          <p>Views: <span>${views}</span></p>\n          <p>Comments: <span>${comments}</span></p>\n          <p>Downloads: <span>${downloads}</span></p>\n        </div>\n      </div>\n    </a>\n  `).join(\"\");\n}\n\nexport function clearGallery(galleryElement) {\n  galleryElement.innerHTML = \"\";\n}\n\nexport function showLoader(loaderElement) {\n  loaderElement.style.display = \"block\";\n}\n\nexport function hideLoader(loaderElement) {\n  loaderElement.style.display = \"none\";\n}\n\nexport function showLoadMoreButton(buttonElement) {\n  buttonElement.style.display = \"block\";\n}\n\nexport function hideLoadMoreButton(buttonElement) {\n  buttonElement.style.display = \"none\";\n}\n","import \"./css/styles.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getPictures, addPages, resetPage } from \"./js/pixabay-api.js\";\nimport { reflectionPictures, clearGallery, hideLoader, showLoader, hideLoadMoreButton, showLoadMoreButton } from \"./js/render-functions.js\";\n\nconst formSearch = document.querySelector(\".form-search\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst btnLoadMore = document.querySelector(\".js-load-more\");\n\nlet lightbox = new SimpleLightbox(\".gallery-item\", {\n  captions: true,\n  captionSelector: \"img\",\n  captionType: \"attr\",\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nformSearch.addEventListener(\"submit\", handlerSearch);\nbtnLoadMore.addEventListener(\"click\", handlerLoadMore);\n\nasync function handlerSearch(event) {\n  event.preventDefault();\n  \n  const query = event.target.elements.query.value.trim();\n  \n  if (!query) {\n    iziToast.error({\n      title: \"Error\",\n      message: \"Please enter a search query!\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  clearGallery(gallery);\n  showLoader(loader);\n  resetPage();\n\n  try {\n    const data = await getPictures(query);\n    \n    if (!data.hits.length) {\n      iziToast.info({\n        title: \"No Results\",\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    gallery.innerHTML = reflectionPictures(data.hits);\n    lightbox.refresh();\n    showLoadMoreButton(btnLoadMore);\n\n  } catch (error) {\n    iziToast.error({\n      title: \"Error\",\n      message: \"Something went wrong. Please try again later!\",\n      position: \"topRight\",\n    });\n    hideLoadMoreButton(btnLoadMore);\n  } finally {\n    hideLoader(loader);\n  }\n}\n\nasync function handlerLoadMore() {\n  try {\n    await addPages();\n\n    const query = formSearch.elements.query.value.trim();\n\n    if (!query) {\n      iziToast.error({\n        title: \"Error\",\n        message: \"Search query is empty!\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    const data = await getPictures(query);\n\n    if (data.hits.length >= data.totalHits) {\n      hideLoadMoreButton(btnLoadMore);\n      iziToast.info({\n        message: \"You've reached the end of search results.\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    gallery.insertAdjacentHTML(\"beforeend\", reflectionPictures(data.hits));\n    lightbox.refresh();\n\n    const cardHeight = gallery.firstElementChild.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 1.2,\n      behavior: \"smooth\",\n    });\n\n  } catch (error) {\n    iziToast.error({\n      title: \"Error\",\n      message: \"Error fetching more images!\",\n      position: \"topRight\",\n    });\n    hideLoadMoreButton(btnLoadMore);\n  }\n}\n"],"names":["page","perPage","BASE_URL","API_KEY","getPictures","query","axios","addPages","resetPage","reflectionPictures","pictures","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","galleryElement","showLoader","loaderElement","hideLoader","showLoadMoreButton","buttonElement","hideLoadMoreButton","formSearch","gallery","loader","btnLoadMore","lightbox","SimpleLightbox","handlerSearch","handlerLoadMore","event","iziToast","data","cardHeight"],"mappings":"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"}